<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>矩阵初等变换</title><style>:root{--p:#4a6fa5;--s:#6b8cb7;--a:#e76f51;--l:#f8f9fa;--d:#333;--w:#fff;--b:#ced4da;--sh:0 4px 6px rgba(0,0,0,.1);--tr:all .3s ease}body{display:flex;flex-direction:column;align-items:center;padding:20px;max-width:1000px;margin:0 auto;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;font-size:16px;background:#f0f4f8;color:var(--d);line-height:1.6}h1{color:var(--p);margin-bottom:30px;text-align:center}@media(max-width:768px){body{padding:15px;font-size:14px}table{margin-top:10px;font-size:13px}td{padding:6px;width:35px}.input_group{flex-direction:column;align-items:stretch}.t_i_group{height:38px;padding:8px 10px;font-size:14px;margin-bottom:8px}}table{border-collapse:collapse;margin:20px auto;box-shadow:var(--sh);background:#fff;transition:var(--tr)}table:hover{box-shadow:0 6px 12px rgba(0,0,0,.15)}td{border:1px solid var(--b);padding:10px 12px;text-align:center;width:50px;transition:var(--tr)}td:hover{background:#f1f7ff}.row-label,.col-label{font-weight:bold;background:#e9ecef;color:var(--p)}.error-popup{position:fixed;bottom:20px;right:20px;background:#ff4757;color:#fff;padding:15px 20px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.15);z-index:10000;max-width:300px;min-width:200px;display:none;opacity:0;transition:opacity .3s ease}.error-popup.show{display:block;opacity:1}.error-popup-close{position:absolute;top:5px;right:10px;background:none;border:none;color:#fff;font-size:20px;cursor:pointer;padding:0;width:25px;height:25px;display:flex;align-items:center;justify-content:center}.info{margin:10px 0;color:var(--p);padding:8px 12px;border-radius:4px;background:#f0f7ff;border:1px solid #cce0ff;width:100%;box-sizing:border-box}input[type=text]{padding:10px 12px;margin-bottom:10px;box-sizing:border-box;border:1px solid var(--b);border-radius:4px;font-size:16px;transition:var(--tr)}input[type=text]:focus{outline:none;border-color:var(--p);box-shadow:0 0 0 3px rgba(74,111,165,.2)}button{margin:0 5px 10px 0;padding:10px 18px;cursor:pointer;background:var(--p);color:var(--w);border:none;border-radius:4px;font-size:15px;transition:var(--tr);font-weight:500}button:hover{background:var(--s);transform:translateY(-2px);box-shadow:var(--sh)}button:active{transform:translateY(0)}button#button_compete{background:#28a745}button#button_compete:hover{background:#218838}button#undo,button#redo{background:#6c757d}button#undo:hover,button#redo:hover{background:#5a6268}button#button_reset{background:#dc3545}button#button_reset:hover{background:#c82333}.full{width:100%;box-sizing:border-box;word-wrap:break-word;overflow-wrap:break-word;white-space:normal;background:#fff;padding:20px;border-radius:8px;box-shadow:var(--sh);margin-top:20px}.t_i_group{height:42px;padding:10px 12px;border:1px solid var(--b);border-radius:4px;font-size:16px;box-sizing:border-box;transition:var(--tr)}.t_i_group:focus{outline:none;border-color:var(--p);box-shadow:0 0 0 3px rgba(74,111,165,.2)}#translate_history{word-wrap:break-word;overflow-wrap:break-word;white-space:normal;max-width:100%;padding:12px;background:#f8f9fa;border-radius:4px;margin:15px 0;border:1px solid #e9ecef}.hidden{display:none!important}.operator_buttons{display:flex;justify-content:center;gap:10px;margin:15px 0;flex-wrap:wrap;align-items:center}.input_group{display:flex;gap:10px;align-items:center;width:100%;justify-content:center;flex-wrap:wrap;margin-bottom:10px}#transform_target,#transform_param{width:140px}#transform_operator{padding:10px;border:1px solid var(--b);border-radius:4px;background:#fff;transition:var(--tr)}#transform_operator:focus{outline:none;border-color:var(--p)}.row-label button,.col-label button{background:transparent;color:var(--p);padding:4px 8px;margin:0;border:1px dashed transparent}.row-label button:hover,.col-label button:hover{background:rgba(74,111,165,.1);border-color:var(--p);transform:none;box-shadow:none}.shortcut_buttons{display:flex;gap:8px;margin:10px 0}.shortcut_buttons button{padding:8px 12px;font-size:16px}.header_buttons{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;justify-content:center}.matrix-container{overflow-x:auto;width:100%;margin:15px 0}</style></head><body><div class="input_group"><input type="text" id="input" placeholder="请输入矩阵"><button id="button_input">录入矩阵</button></div><button id="button_example">生成示例行列式</button><button id="button_compete" style="display:none">计算行列式的值</button><button id="button_reset">重置</button><div class="full hidden"><div class="operator_buttons"><div class="input_group"><input type="text" id="transform_target" placeholder="目标行/列" class="t_i_group"><select id="transform_operator" class="t_i_group"><option value="">选择操作</option><option value="+">+</option><option value="-">-</option><option value="*">×</option><option value="↔">↔</option></select><input type="text" id="transform_param" placeholder="参数" class="t_i_group"><button id="button_translate">执行初等变换</button></div></div><div class="operator_buttons"><p>快捷符号</p><button id="button_change">↔</button><button id="button_add">+</button><button id="button_sub">−</button><button id="button_mul">×</button></div><p id="translate_history">初等变换历史记录：</p><button id="undo">撤销初等变换</button><button id="redo">重做初等变换</button></div><div id="result"></div><div id="det"></div><div id="errorPopup" class="error-popup"><button class="error-popup-close" onclick="hideErrorPopup()">×</button><div class="error-popup-content" id="errorPopupContent"></div></div><script src="https://cdn.jsdelivr.net/npm/mathjs@11.8.0/lib/browser/math.min.js"></script><script>var input_box=document.getElementById('input'),button=document.getElementById('button_input'),result_display=document.getElementById('result'),det_display=document.getElementById('det'),button_example=document.getElementById('button_example'),button_compete=document.getElementById('button_compete'),button_reset=document.getElementById('button_reset'),errorPopup=document.getElementById('errorPopup'),errorPopupContent=document.getElementById('errorPopupContent'),autoHideTimer=null,matrix=[],row_count=0,col_count=0,transform_target=document.getElementById('transform_target'),transform_operator=document.getElementById('transform_operator'),transform_param=document.getElementById('transform_param'),button_translate=document.getElementById('button_translate'),translate_history=document.getElementById('translate_history'),translate_history_array=[],button_undo=document.getElementById('undo'),button_redo=document.getElementById('redo'),translate_number=-1;function fullwidth_to_haifwidth(t){for(var r='',i=0;i<t.length;i++){var a=t.charCodeAt(i);r+=a>=65281&&a<=65374?String.fromCharCode(a-65248):12288===a?String.fromCharCode(32):t.charAt(i)}return r}function showErrorPopup(t){var r=document.getElementById('errorPopup'),o=document.getElementById('errorPopupContent');autoHideTimer&&clearTimeout(autoHideTimer),o.textContent=t,r.classList.add('show'),autoHideTimer=setTimeout(()=>{hideErrorPopup()},5e3)}function hideErrorPopup(){var t=document.getElementById('errorPopup');autoHideTimer&&clearTimeout(autoHideTimer),t.style.opacity='0',setTimeout(()=>{t.classList.remove('show'),t.style.opacity='1'},300)}function renderMatrix(){for(var t='<table>',r=0;r<matrix.length;r++){t+='<tr>';for(var o=0;o<matrix[r].length;o++)t+='<td>'+matrix[r][o]+'</td>';var a='button_add_r'+(r+1);t+='<td class="row-label"><button id="'+a+'">r'+(r+1)+'</button></td>',t+='</tr>'}t+='<tr>';for(o=0;o<col_count;o++){var e='button_add_c'+(o+1);t+='<td class="col-label"><button id="'+e+'">c'+(o+1)+'</button></td>'}t+='<td></td></tr></table>';var i='<div class="info">矩阵维度：'+row_count+'×'+col_count+'</div>',n=result_display.innerHTML,s=/转换后的矩阵：<br>.*?<div class="info">矩阵维度：.*?<\/div>/s;s.test(n)?result_display.innerHTML=n.replace(s,'转换后的矩阵：<br>'+t+i):result_display.innerHTML='转换后的矩阵：<br>'+t+i}function parseRowCol(t){if(!t)return null;var r=t.trim();if(r.length<2)return null;var o=r.charAt(0).toLowerCase();if('r'!==o&&'c'!==o)return null;var a=parseInt(r.substring(1));return isNaN(a)||a<1?null:{type:'r'===o?'r':'c',index:a-1}}function parseParam(t){if(!t)return null;var r=t.trim();if(r.includes('*')){var o=r.split('*');if(2===o.length){var a=parseFloat(o[0].trim());if(!isNaN(a)){var e=parseRowCol(o[1].trim());if(e)return{type:'scalar_rowcol',scalar:a,rowCol:e}}}}var i=parseRowCol(r);if(i)return{type:'rowcol',rowCol:i};var n=parseFloat(r);return isNaN(n)?null:{type:'scalar',value:n}}function performElementaryTransformation(t,r,o){var a=parseRowCol(t);if(!a)return showErrorPopup('错误：无效的目标行/列格式'),!1;var e=parseParam(o);if(!e)return showErrorPopup('错误：无效的参数格式'),!1;switch(r){case'+':case'-':return performAdditionTransformation(a,r,e);case'*':return performMultiplyTransformation(a,e);case'↔':return performSwapTransformation(a,e);default:return showErrorPopup('错误：无效的运算符'),!1}}function performAdditionTransformation(t,r,o){if('rowcol'!==o.type&&'scalar_rowcol'!==o.type)return showErrorPopup('错误：加法/减法运算需要行/列作为参数'),!1;var a='rowcol'===o.type?o.rowCol:o.rowCol,e='scalar_rowcol'===o.type?o.scalar:1;'-'===r&&(e=-e);if(t.type!==a.type)return showErrorPopup('错误：行变换和列变换不能混合使用'),!1;if('r'===t.type){if(t.index<0||t.index>=row_count||a.index<0||a.index>=row_count)return showErrorPopup('错误：无效的行索引'),!1;for(var i=0;i<col_count;i++)matrix[t.index][i]+=e*matrix[a.index][i]}else{if(t.index<0||t.index>=col_count||a.index<0||a.index>=col_count)return showErrorPopup('错误：无效的列索引'),!1;for(i=0;i<row_count;i++)matrix[i][t.index]+=e*matrix[i][a.index]}return!0}function performMultiplyTransformation(t,r){if('scalar'!==r.type)return showErrorPopup('错误：乘法运算需要数字作为参数'),!1;var o=r.value;if(0===o)return showErrorPopup('错误：标量系数不能为0'),!1;if('r'===t.type){if(t.index<0||t.index>=row_count)return showErrorPopup('错误：无效的行索引'),!1;for(var a=0;a<col_count;a++)matrix[t.index][a]*=o}else{if(t.index<0||t.index>=col_count)return showErrorPopup('错误：无效的列索引'),!1;for(a=0;a<row_count;a++)matrix[a][t.index]*=o}return!0}function performSwapTransformation(t,r){if('rowcol'!==r.type)return showErrorPopup('错误：交换运算需要行/列作为参数'),!1;var o=r.rowCol;if(t.type!==o.type)return showErrorPopup('错误：行变换和列变换不能混合使用'),!1;if('r'===t.type){if(t.index<0||t.index>=row_count||o.index<0||o.index>=row_count)return showErrorPopup('错误：无效的行索引'),!1;var a=matrix[t.index];matrix[t.index]=matrix[o.index],matrix[o.index]=a}else{if(t.index<0||t.index>=col_count||o.index<0||o.index>=col_count)return showErrorPopup('错误：无效的列索引'),!1;for(var e=0;e<row_count;e++){var i=matrix[e][t.index];matrix[e][t.index]=matrix[e][o.index],matrix[e][o.index]=i}}return!0}function updateHistoryDisplay(){if(translate_number<0)return void(translate_history.innerText='初等变换历史记录：');var t=translate_history_array.slice(0,translate_number+1).join('; ');translate_history.innerText='初等变换历史记录：'+t}function undoTransformation(t){for(var r=-1,o=['↔','+','-','*'],a=0;a<o.length;a++)if(-1!==(r=t.indexOf(o[a])))break;if(-1===r)return!1;var e=t.substring(0,r),i=t.charAt(r),n=t.substring(r+1);switch(i){case'+':return performElementaryTransformation(e,'-',n);case'-':return performElementaryTransformation(e,'+',n);case'*':var s=parseParam(n);return!(!s||'scalar'!==s.type)&&performElementaryTransformation(e,'*',(1/s.value).toString());case'↔':return performElementaryTransformation(e,'↔',n);default:return!1}}function parseAndExecuteTransformation(t){for(var r=-1,o=['↔','+','-','*'],a=0;a<o.length;a++)if(-1!==(r=t.indexOf(o[a])))break;if(-1===r)return!1;var e=t.substring(0,r),i=t.charAt(r),n=t.substring(r+1);return performElementaryTransformation(e,i,n)}button.addEventListener('click',function(){var t=!0,r='';matrix=[],row_count=0,col_count=0,translate_history_array=[],translate_number=-1;var o=input_box.value.trim();if(result_display.innerHTML='',det_display.innerHTML='',translate_history.innerHTML='初等变换历史记录：',o){o=fullwidth_to_haifwidth(o);for(var a=o.split(';'),e=0;e<a.length;e++){var i=a[e].trim();if(i){for(var n=i.split(','),s=[],l=0;l<n.length;l++){var u=n[l].trim();if(u){if(isNaN(parseFloat(u))){t=!1,r='第'+(e+1)+'行第'+(l+1)+'个元素不是有效数字';break}s.push(parseFloat(u))}}if(!t)break;if(s.length>0&&(matrix.length>0&&s.length!==matrix[0].length&&(t=!1,r='第'+(e+1)+'行的列数与第1行不一致'),!t))break;t&&s.length>0&&matrix.push(s)}}if(row_count=matrix.length,row_count>0&&(col_count=matrix[0].length),!t)showErrorPopup('错误：'+r);else if(0===row_count)showErrorPopup('错误：未能解析出有效矩阵');else if(0===col_count)showErrorPopup('错误：矩阵的列数为0，不是有效矩阵');else{renderMatrix(),console.log('矩阵：',matrix),console.log('行数：',row_count),console.log('列数：',col_count),document.getElementsByClassName('full')[0].classList.remove('hidden'),button_compete.style.display='block'}}else showErrorPopup('错误：请输入内容')}),button_example.addEventListener('click',function(){input_box.value='1,2,3;4,5,6;7,8,9;',button.click()}),button_compete.addEventListener('click',function(){row_count===col_count?function(){try{var t=math.det(matrix);det_display.innerHTML='<div class="info">行列式的值为：'+t+'</div>'}catch(t){showErrorPopup('计算行列式时出错：'+t.message)}}():det_display.innerHTML='<div class="info">只有方阵才能计算行列式，当前矩阵不是方阵</div>'}),button_reset.addEventListener('click',function(){input_box.value='',matrix=[],row_count=0,col_count=0,result_display.innerHTML='',det_display.innerHTML='',button_compete.style.display='none',document.getElementsByClassName('full')[0].classList.add('hidden'),document.getElementById('transform_target').value='',document.getElementById('transform_operator').value='',document.getElementById('transform_param').value='',translate_history.innerHTML='初等变换历史记录：',translate_history_array=[],translate_number=0}),document.getElementById('result').addEventListener('click',function(t){const r=t.target;if(r.id.startsWith('button_add_r')||r.id.startsWith('button_add_c')){const t=r.id.includes('r')?'r':'c',o=r.textContent.replace(t,'');transform_target.value.trim()?transform_param.value+=t+o:transform_target.value+=t+o}}),button_translate.addEventListener('click',function(){var t=transform_target.value.trim(),r=transform_operator.value,o=transform_param.value.trim();if(t&&r&&o){if(performElementaryTransformation(t,r,o)){var a=t+r+o;translate_history_array.push(a),translate_number=translate_history_array.length-1,updateHistoryDisplay(),renderMatrix(),transform_target.value='',transform_operator.value='',transform_param.value=''}}else showErrorPopup('错误：请填写完整的变换信息')}),document.getElementById('button_change').addEventListener('click',function(){transform_operator.value='↔'}),document.getElementById('button_add').addEventListener('click',function(){transform_operator.value='+'}),document.getElementById('button_sub').addEventListener('click',function(){transform_operator.value='-'}),document.getElementById('button_mul').addEventListener('click',function(){transform_operator.value='*'}),button_undo.addEventListener('click',function(){translate_number>=0&&undoTransformation(translate_history_array[translate_number])&&(translate_number--,updateHistoryDisplay(),renderMatrix())}),button_redo.addEventListener('click',function(){translate_number<translate_history_array.length-1&&(translate_number++,parseAndExecuteTransformation(translate_history_array[translate_number])&&(updateHistoryDisplay(),renderMatrix()))});</script></body></html>